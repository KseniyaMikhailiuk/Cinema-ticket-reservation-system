import {v4} from 'uuid'

const cinemaHallPlans = [
    {
        cityName: "Минск",
        cinemas: [
            {
                name: "Арена сити",
                halls: [
                    {
                        number: 1,
                        plan: [
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 1,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 2,
                                    line: 1,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 3,
                                    line: 1,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 4,
                                    line: 1,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 5,
                                    line: 1,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 2,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 3,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 4,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 5,
                                    line: 2,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 3,
                                },
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 2,
                                    line: 3,
                                },
                        
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 3,
                                    line: 3, 
                                },
                            ]
                        
                        ]
                    },
                    {
                        number: 2,
                        plan: [
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                        
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2, 
                                },
                            ]
                        
                        ]
                    }
                ]
            },
            {
                name: "Аврора",
                halls: [
                    {
                        number: 1,
                        plan: [
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "comfort",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                            ],
                            [
                                {
                                    id: v4(),
                                    type: "standard",
                                    price: 10, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2,
                                },
                        
                                {
                                    id: v4(),
                                    type: "loveseat",
                                    price: 20, 
                                    occupied: false,
                                    raw: 1,
                                    line: 2, 
                                },
                            ]
                        
                        ]
                    }
                ]
            }
        ]
    }
]

export default cinemaHallPlans;

const delay = (ms) => 
    new Promise(resolve => setTimeout(resolve, ms));

export const fetchHallPlan = (seanceInfo) => 
    delay(500)
    .then(() => {
        var plan = []
        cinemaHallPlans
        .forEach(city => {
            if (city.cityName === seanceInfo.city) {
                city
                    .cinemas
                    .forEach(cinema => {
                        if (cinema.name === seanceInfo.cinema) {
                            cinema
                                .halls
                                .forEach(hall => {   
                                    if (hall.number === seanceInfo.hall) {
                                        plan = hall.plan;
                                    }
                                })
                        }
                    })
            }
        })            
        return plan;
    })

export const occupySeat = (seatInfo) => 
    delay(500)
    .then(() => {
        let selectedSeat = {};
        cinemaHallPlans
        .find(city => 
            city.cityName === seatInfo.selectedSeanceInfo.city)
            .cinemas
            .find(cinema =>
                cinema.name === seatInfo.selectedSeanceInfo.cinema)
                .halls
                .find(hall => 
                    hall.number === seatInfo.selectedSeanceInfo.hall)
                    .plan
                    .forEach(line => {
                        line
                        .forEach(seat => {
                            if (seat.id === seatInfo.seatId) {
                                seat.occupied = true;
                                selectedSeat = seat;
                            }
                        })
                    })
        return selectedSeat;
    })